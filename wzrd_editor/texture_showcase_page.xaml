<Page
    x:Class="wzrd_editor.texture_showcase_page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:graphics="using:graphics"
    xmlns:local="using:wzrd_editor"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:wzrd_editor"
    mc:Ignorable="d">

    <Page.Resources>

        <converters:bool_invert x:Key="bool_invert_converter"/>

        <DataTemplate x:Key="textures_list_template" x:DataType="graphics:texture" >
            <ListViewItem
                HorizontalContentAlignment="Stretch"
                PointerEntered="onmouseenter_textures_list"
                PointerExited="onmouseexit_textures_list">
                <Image x:Name="texture_img" Source="{x:Bind bitmap_source, Mode=TwoWay}"
                           Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" Grid.ColumnSpan="1">
                    <Image.Transitions>
                        <TransitionCollection>
                            <RepositionThemeTransition />
                            <AddDeleteThemeTransition />
                            <ContentThemeTransition/>
                        </TransitionCollection>
                    </Image.Transitions>
                </Image>

                <!--<Grid HorizontalAlignment="Stretch" x:Name="textures_info_grid">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Button x:Name="first_btn" HorizontalAlignment="Stretch" Content="first" 
                           Grid.Row="0" Grid.Column="1" Grid.RowSpan="1" Grid.ColumnSpan="1">
                        <Button.Transitions>
                            <TransitionCollection>
                                <RepositionThemeTransition />
                            </TransitionCollection>
                        </Button.Transitions>
                    </Button>

                    <Button HorizontalAlignment="Stretch" Content="second" 
                           Grid.Row="1" Grid.Column="1" Grid.RowSpan="1" Grid.ColumnSpan="1"/>
                </Grid>-->

            </ListViewItem>
        </DataTemplate>

        <DataTemplate x:Key="shaders_list_template" x:DataType="graphics:shader" >
            <ListViewItem>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Top" Margin="8,8,0,0">
                    <SymbolIcon Margin="0,0,13,0" x:Name="shader_type_icon" Symbol="{x:Bind type_glyph}"></SymbolIcon>
                    <TextBlock Margin="0,0,13,0" Text="{x:Bind shader_name, Mode=TwoWay}">
                        <TextBlock.Transitions>
                            <TransitionCollection>
                                <RepositionThemeTransition />
                                <AddDeleteThemeTransition />
                                <ContentThemeTransition/>
                                <EntranceThemeTransition IsStaggeringEnabled="True" />
                            </TransitionCollection>
                        </TextBlock.Transitions>
                    </TextBlock>
                    <ProgressRing Margin="0,0,13,0" Visibility="{x:Bind is_loading, Mode=OneWay}" IsActive="{x:Bind is_loading, Mode=TwoWay}"/>
                    <TextBlock Text="Compilation failed." Visibility="{x:Bind is_error,Mode=OneWay}" Foreground="{StaticResource SystemControlErrorTextForegroundBrush}"/>

                    <StackPanel Visibility="{x:Bind is_loading, Converter={StaticResource bool_invert_converter}, Mode=OneWay}" Orientation="Vertical">
                        <TextBlock Text="{x:Bind file_name, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind version, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind compiler, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind bound_resources_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind output_parameters_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind input_parameters_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind constant_buffer_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind instruction_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind texture_bias_instructions_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind texture_comparison_instructions_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind texture_gradient_instructions_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind texture_load_instructions_count, Mode=OneWay}"/>
                        <TextBlock Text="{x:Bind texture_normal_instructions_count, Mode=OneWay}"/>
                    </StackPanel>

                </StackPanel>
            </ListViewItem>
        </DataTemplate>
    </Page.Resources>

    <SplitView x:Name="split_pane" IsPaneOpen="False" DisplayMode="Inline" OpenPaneLength="800">
        <StackPanel>
            <Button x:Name="start_render" Click="render_onclick" Content="render"></Button>

            <Pivot x:Name="assets_pivot">
                <PivotItem Header="Textures">
                    <StackPanel Orientation="Vertical">
                        <CommandBar x:Name="textures_cmd_bar" Background="Transparent" IsOpen="False" DefaultLabelPosition="Right" HorizontalAlignment="Left">
                            <AppBarButton Icon="Add" Label="Add" x:Name="textures_picker" Click="onclick_pick_texture"/>
                            <AppBarButton Icon="Edit" Label="Edit"/>
                            <AppBarButton Icon="Delete" Label="Delete" x:Name="menuflyout_clear_textures" Click="menuflyout_clear_textures_click"/>
                        </CommandBar>

                        <ListView x:Name="textures_list" 
                                  HorizontalAlignment="Left"
                                  ItemTemplate="{StaticResource textures_list_template}"
                                  ItemsSource="{x:Bind texture_showcase_vm.textures}"
                                  VerticalContentAlignment="Stretch"
                                  HorizontalContentAlignment="Stretch"
                                  Visibility="Visible" >

                            <ListView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <AddDeleteThemeTransition />
                                    <RepositionThemeTransition />
                                </TransitionCollection>
                            </ListView.ItemContainerTransitions>
                            <ListView.Resources>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="VerticalAlignment" Value="Stretch"></Setter>
                                    <Setter Property="VerticalContentAlignment" Value="Stretch"></Setter>
                                    <Setter Property="MaxHeight" Value="1000"></Setter>
                                    <Setter Property="MaxWidth" Value="1000"></Setter>
                                    <Setter Property="Width" Value="700"></Setter>
                                </Style>
                                <Style TargetType="Image">
                                    <Setter Property="Width" Value="100"></Setter>
                                    <Setter Property="Height" Value="100"></Setter>
                                    <Setter Property="VerticalAlignment" Value="Top"></Setter>
                                    <Setter Property="HorizontalAlignment" Value="Left"></Setter>
                                </Style>
                            </ListView.Resources>
                        </ListView>
                    </StackPanel>
                </PivotItem>
                <PivotItem Header="Shaders">

                    <StackPanel Orientation="Vertical">
                        <CommandBar x:Name="shaders_cmd_bar" Background="Transparent" IsOpen="False" DefaultLabelPosition="Right" HorizontalAlignment="Left">
                            <AppBarButton Icon="Add" Label="Add" x:Name="shaderPicker">
                                <AppBarButton.Flyout>
                                    <MenuFlyout>
                                        <MenuFlyoutItem x:Name="pixelShaderPicker" Click="onclick_pixelshader_picker">
                                            <MenuFlyoutItem.Icon>
                                                <SymbolIcon Symbol="SelectAll"></SymbolIcon>
                                            </MenuFlyoutItem.Icon>
                                            <MenuFlyoutItem.Text>Pixel</MenuFlyoutItem.Text>
                                            <MenuFlyoutItem.KeyboardAccelerators>
                                                <KeyboardAccelerator Key="P" Modifiers="Shift"/>
                                            </MenuFlyoutItem.KeyboardAccelerators>
                                        </MenuFlyoutItem>

                                        <MenuFlyoutItem x:Name="vertexShaderPicker" Click="onclick_vertexshader_picker">
                                            <MenuFlyoutItem.Icon>
                                                <SymbolIcon Symbol="Play"></SymbolIcon>
                                            </MenuFlyoutItem.Icon>
                                            <MenuFlyoutItem.Text>Vertex</MenuFlyoutItem.Text>
                                            <MenuFlyoutItem.KeyboardAccelerators>
                                                <KeyboardAccelerator Key="V" Modifiers="Shift"/>
                                            </MenuFlyoutItem.KeyboardAccelerators>
                                        </MenuFlyoutItem>
                                    </MenuFlyout>
                                </AppBarButton.Flyout>
                            </AppBarButton>
                            <AppBarButton Icon="Edit" Label="Edit"/>
                            <AppBarButton Icon="Delete" Label="Delete" x:Name="menuflyout_clear_shaders" Click="menuflyout_clear_shaders_click"/>
                        </CommandBar>
                        <ListView x:Name="shaders_list" 
                                  HorizontalAlignment="Left"
                                  ItemTemplate="{StaticResource shaders_list_template}"
                                  ItemsSource="{x:Bind texture_showcase_vm.shaders}"
                                  VerticalContentAlignment="Stretch"
                                  HorizontalContentAlignment="Stretch"
                                  Visibility="Visible" >

                            <ListView.ItemContainerTransitions>
                                <TransitionCollection>
                                    <AddDeleteThemeTransition />
                                    <RepositionThemeTransition />
                                    <EntranceThemeTransition IsStaggeringEnabled="True" />
                                </TransitionCollection>
                            </ListView.ItemContainerTransitions>

                            <ListView.Resources>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="VerticalAlignment" Value="Stretch"></Setter>
                                    <Setter Property="VerticalContentAlignment" Value="Stretch"></Setter>
                                    <Setter Property="MaxHeight" Value="1000"></Setter>
                                    <Setter Property="MaxWidth" Value="1000"></Setter>
                                    <Setter Property="Width" Value="700"></Setter>
                                </Style>
                                <Style TargetType="Image">
                                    <Setter Property="Width" Value="100"></Setter>
                                    <Setter Property="Height" Value="100"></Setter>
                                    <Setter Property="VerticalAlignment" Value="Top"></Setter>
                                    <Setter Property="HorizontalAlignment" Value="Left"></Setter>
                                </Style>
                            </ListView.Resources>
                        </ListView>
                    </StackPanel>
                </PivotItem>
            </Pivot>

        </StackPanel>
        <SplitView.Pane>
            <SwapChainPanel x:Name="swapchain_panel" Width="700" Height="700" HorizontalAlignment="Center" VerticalAlignment="Center" />
        </SplitView.Pane>

    </SplitView>
</Page>
